# portmap
 
# Installation
```
go install -v github.com/rix4uni/portmap@latest
```

# Usage
```
Usage of portmap:
  -asn
        Show ASN
  -c int
        Number of threads to use (default 8)
  -exclude-ports string
        Exclude ports (comma-separated)
  -ip
        Show IP address
  -o string
        Output file
  -v    Prints current version
```

# Usage Example

Single URL:
```
echo "104.18.36.214" | portmap
104.18.36.214:8080
104.18.36.214:2082
104.18.36.214:2083
104.18.36.214:2053
104.18.36.214:2086
104.18.36.214:2087
104.18.36.214:80
104.18.36.214:8880
104.18.36.214:8443
104.18.36.214:443

echo "104.18.36.214" | portmap -c 100 -asn
104.18.36.214:8080 AS13335
104.18.36.214:2082 AS13335
104.18.36.214:2083 AS13335
104.18.36.214:2053 AS13335
104.18.36.214:2086 AS13335
104.18.36.214:2087 AS13335
104.18.36.214:80 AS13335
104.18.36.214:8880 AS13335
104.18.36.214:8443 AS13335
104.18.36.214:443 AS13335

echo "104.18.36.214" | portmap -c 100 -ip
104.18.36.214:8080  104.18.36.214
104.18.36.214:2082  104.18.36.214
104.18.36.214:2083  104.18.36.214
104.18.36.214:2053  104.18.36.214
104.18.36.214:2086  104.18.36.214
104.18.36.214:2087  104.18.36.214
104.18.36.214:80  104.18.36.214
104.18.36.214:8880  104.18.36.214
104.18.36.214:8443  104.18.36.214
104.18.36.214:443  104.18.36.214

echo "104.18.36.214" | portmap -c 100 -asn -ip
104.18.36.214:8080 AS13335 104.18.36.214
104.18.36.214:2082 AS13335 104.18.36.214
104.18.36.214:2083 AS13335 104.18.36.214
104.18.36.214:2053 AS13335 104.18.36.214
104.18.36.214:2086 AS13335 104.18.36.214
104.18.36.214:2087 AS13335 104.18.36.214
104.18.36.214:80 AS13335 104.18.36.214
104.18.36.214:8880 AS13335 104.18.36.214
104.18.36.214:8443 AS13335 104.18.36.214
104.18.36.214:443 AS13335 104.18.36.214

## remove port 80,443
echo "104.18.36.214" | portmap -c 100 -exclude-ports 80,443
104.18.36.214:8080
104.18.36.214:2082
104.18.36.214:2083
104.18.36.214:2053
104.18.36.214:2086
104.18.36.214:2087
104.18.36.214:8880
104.18.36.214:8443

## save output in a file
echo "104.18.36.214" | portmap -c 100 -exclude-ports 80,443 -o output.txt
104.18.36.214:8080
104.18.36.214:2082
104.18.36.214:2083
104.18.36.214:2053
104.18.36.214:2086
104.18.36.214:2087
104.18.36.214:8880
104.18.36.214:8443
```

Multiple URLs:
```
cat urls.txt | portmap -c 100
```
subs.txt contains:
```
104.18.36.214
104.18.39.102
```

Output:
```
104.18.36.214:8080
104.18.36.214:2082
104.18.36.214:2083
104.18.36.214:2053
104.18.36.214:2086
104.18.36.214:2087
104.18.36.214:80
104.18.36.214:8880
104.18.36.214:8443
104.18.36.214:443
104.18.39.102:2096
104.18.39.102:2082
104.18.39.102:2083
104.18.39.102:2053
104.18.39.102:2086
104.18.39.102:2087
104.18.39.102:2095
104.18.39.102:80
104.18.39.102:8880
104.18.39.102:8080
104.18.39.102:8443
104.18.39.102:443
```

curl oneliner
```
curl -s "https://api.shodan.io/shodan/host/106.11.35.30" | jq '{domains: .domains, hostnames: .hostnames, vulns: .vulns, asn: .asn, ip: .ip_str, "ip_ports": [.ports[] as $p | "\(.ip_str):\($p)"]}'
```
